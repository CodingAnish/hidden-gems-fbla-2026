{% extends "base.html" %}
{% block title %}Home{% endblock %}
{% block content %}

<!-- ===== HERO SECTION WITH SEARCH ===== -->
<!-- Large hero banner with gradient background and search form -->
<section class="hero" style="background: linear-gradient(135deg, var(--color-primary-light) 0%, #a5f3fc 50%, rgba(6, 182, 212, 0.05) 100%);">
  <!-- Main heading - "Find Your Next Favorite" -->
  <h1 class="page-title">Find Your Next Favorite</h1>
  <!-- Subtitle describing the app's purpose -->
  <p class="page-subtitle">Discover hidden gems, trending businesses, and exclusive deals in Richmond.</p>
  
  <!-- SEARCH FORM - GET request to directory with query parameter -->
  <!-- Allows users to search for specific businesses or categories -->
  <form action="{{ url_for('directory') }}" method="get" style="display: flex; gap: 1rem; max-width: 600px; flex-wrap: wrap; margin-top: 2rem;">
    <!-- Search input field - Accepts business names or categories -->
    <input type="text" name="q" placeholder="Search businesses, categories..." style="flex: 1; min-width: 250px; padding: 1rem 1.5rem; border: 2px solid white; border-radius: 10px; font-size: 1rem;">
    <!-- Search submit button -->
    <button type="submit" class="btn btn-primary">Search</button>
  </form>
</section>

<!-- ===== BROWSE BY CATEGORY SECTION ===== -->
<!-- Quick access to popular business categories -->
<div class="section">
  <!-- Section header with title -->
  <div class="section-header">
    <h2 class="section-title">Browse by Category</h2>
  </div>
  
  <!-- CATEGORY CHIPS - Clickable tags for each category -->
  <div class="category-chips">
    <!-- Food Category - Restaurants, cafes, food businesses -->
    <a href="{{ url_for('directory', category='Food') }}" class="category-chip" style="text-decoration: none;">
       Food
    </a>
    <!-- Retail Category - Shops, boutiques, stores -->
    <a href="{{ url_for('directory', category='Retail') }}" class="category-chip" style="text-decoration: none;">
       Retail
    </a>
    <!-- Services Category - Salons, repairs, consulting, etc. -->
    <a href="{{ url_for('directory', category='Services') }}" class="category-chip" style="text-decoration: none;">
       Services
    </a>
    <!-- Entertainment Category - Bars, theaters, recreation -->
    <a href="{{ url_for('directory', category='Entertainment') }}" class="category-chip" style="text-decoration: none;">
       Entertainment
    </a>
    <!-- Health & Wellness Category - Gyms, spas, medical services -->
    <a href="{{ url_for('directory', category='Health and Wellness') }}" class="category-chip" style="text-decoration: none;">
       Wellness
    </a>
    <!-- View All Button - Link to full directory -->
    <a href="{{ url_for('directory') }}" class="category-chip" style="text-decoration: none;">
      üëÅÔ∏è View All
    </a>
  </div>
</div>

<!-- DIVIDER - Visual separator between sections -->
<div class="divider"></div>

<!-- ===== FEATURED BUSINESSES SECTION ===== -->
<!-- Handpicked local businesses highlighted by administrators -->
<div class="section">
  <!-- Section header with title and subtitle -->
  <div class="section-header">
    <h2 class="section-title">Featured This Week</h2>
    <p class="section-subtitle">Handpicked local favorites</p>
  </div>
  
  <!-- DISPLAY FEATURED BUSINESSES IF DATA EXISTS -->
  {% if featured %}
  <!-- Grid layout for business cards (responsive, 320px minimum width) -->
  <div class="grid" style="grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 2rem;">
    <!-- LOOP THROUGH FEATURED BUSINESSES - Limit to 6 cards display -->
    {% for b in featured[:6] %}
    <!-- BUSINESS CARD COMPONENT -->
    <div class="business-card">
      <!-- BUSINESS IMAGE SECTION -->
      <!-- Displays business photo if available, otherwise gradient background -->
      <div class="business-card-image" style="height: 200px; font-size: 72px; background-size: cover; background-position: center; {% if b.photo_url %}background-image: url('{{ b.photo_url }}'); background-color: rgba(0,0,0,0.1);{% else %}background: linear-gradient(135deg, #cffafe 0%, #a5f3fc 100%);{% endif %} display: flex; align-items: center; justify-content: center; {% if not b.photo_url %}backdrop-filter: blur(4px);{% else %}opacity: 0.95;{% endif %}">
        <!-- CATEGORY EMOJI (fallback display if no photo) -->
        {% if not b.photo_url %}
          {% if b.category == 'Food' %}
          {% elif b.category == 'Retail' %}
          {% elif b.category == 'Services' %}
          {% elif b.category == 'Entertainment' %}
          {% elif b.category == 'Health and Wellness' %}
          {% else %}
          {% endif %}
        {% endif %}
      </div>
      
      <!-- BUSINESS CARD CONTENT -->
      <div class="business-card-content" style="padding: 1.5rem;">
        <!-- Business name as heading -->
        <h3 class="business-card-title" style="margin-bottom: 0.75rem;">{{ b.name }}</h3>
        <!-- Business category badge -->
        <span class="business-category" style="margin-bottom: 1rem; display: inline-block;">{{ b.category }}</span>
        <!-- RATING DISPLAY -->
        <!-- Shows star icon, average rating, and number of reviews -->
        <div class="business-rating" style="margin-bottom: 1rem;">
          <span class="star">‚≠ê</span>
          <strong>{{ "%.1f"|format(b.average_rating or 0) }}</strong>
          <span style="color: var(--color-text-muted); font-size: 0.9rem;">({{ b.total_reviews or 0 }})</span>
        </div>
        <!-- BUSINESS DESCRIPTION - Brief summary of business highlight -->
        <!-- Displays custom summary if available, otherwise general description -->
        {% if b.summary %}
        <p class="business-description" style="margin-bottom: 1.5rem; flex: 1; font-size: 0.9rem; color: var(--color-text-muted); font-style: italic;">{{ b.summary }}</p>
        {% else %}
        <p class="business-description" style="margin-bottom: 1.5rem; flex: 1;">{{ b.description or 'Great local business' }}</p>
        {% endif %}
        <!-- VIEW DETAILS BUTTON - Links to full business page -->
        <a href="{{ url_for('business_detail', business_id=b.id) }}" class="btn btn-primary btn-sm" style="width: 100%; text-align: center;">View Details</a>
      </div>
    </div>
    {% endfor %}
  </div>
  {% endif %}
</div>

<!-- DIVIDER - Visual separator between sections -->
<div class="divider"></div>

<!-- ===== TRENDING BUSINESSES SECTION ===== -->
<!-- Currently popular/most viewed businesses based on recent activity -->
<div class="section">
  <!-- Section header with title and subtitle -->
  <div class="section-header">
    <h2 class="section-title">Trending Now</h2>
    <p class="section-subtitle">Most popular this week</p>
  </div>
  
  <!-- DISPLAY TRENDING BUSINESSES IF DATA EXISTS -->
  {% if trending %}
  <!-- Grid layout for business cards (responsive, 320px minimum width) -->
  <div class="grid" style="grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 2rem;">
    <!-- LOOP THROUGH TRENDING BUSINESSES - Limit to 3 cards display -->
    {% for b in trending[:3] %}
    <!-- BUSINESS CARD COMPONENT (same as featured section) -->
    <div class="business-card">
      <!-- BUSINESS IMAGE SECTION -->
      <!-- Displays business photo with yellow gradient if no image (trending theme color) -->
      <div class="business-card-image" style="height: 200px; font-size: 72px; background-size: cover; background-position: center; {% if b.photo_url %}background-image: url('{{ b.photo_url }}'); background-color: rgba(0,0,0,0.1);{% else %}background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);{% endif %} display: flex; align-items: center; justify-content: center; {% if not b.photo_url %}backdrop-filter: blur(4px);{% else %}opacity: 0.95;{% endif %}">
        <!-- CATEGORY EMOJI (fallback display if no photo) -->
        {% if not b.photo_url %}
          {% if b.category == 'Food' %}
          {% elif b.category == 'Retail' %}
          {% elif b.category == 'Services' %}
          {% elif b.category == 'Entertainment' %}
          {% elif b.category == 'Health and Wellness' %}
          {% else %}
          {% endif %}
        {% endif %}
      </div>
      
      <!-- BUSINESS CARD CONTENT -->
      <div class="business-card-content" style="padding: 1.5rem;">
        <!-- Business name as heading -->
        <h3 class="business-card-title" style="margin-bottom: 0.75rem;">{{ b.name }}</h3>
        <!-- Business category badge -->
        <span class="business-category" style="margin-bottom: 1rem; display: inline-block;">{{ b.category }}</span>
        <!-- RATING DISPLAY -->
        <!-- Shows star icon, average rating, and number of reviews -->
        <div class="business-rating" style="margin-bottom: 1rem;">
          <span class="star">‚≠ê</span>
          <strong>{{ "%.1f"|format(b.average_rating or 0) }}</strong>
          <span style="color: var(--color-text-muted); font-size: 0.9rem;">({{ b.total_reviews or 0 }})</span>
        </div>
        <!-- BUSINESS DESCRIPTION - Brief summary of business highlight -->
        <!-- Displays custom summary if available, otherwise general description -->
        {% if b.summary %}
        <p class="business-description" style="margin-bottom: 1.5rem; flex: 1; font-size: 0.9rem; color: var(--color-text-muted); font-style: italic;">{{ b.summary }}</p>
        {% else %}
        <p class="business-description" style="margin-bottom: 1.5rem; flex: 1;">{{ b.description or 'Great local business' }}</p>
        {% endif %}
        <!-- VIEW DETAILS BUTTON - Links to full business page -->
        <a href="{{ url_for('business_detail', business_id=b.id) }}" class="btn btn-primary btn-sm" style="width: 100%; text-align: center;">View Details</a>
      </div>
    </div>
    {% endfor %}
  </div>
  {% endif %}
  
  <!-- SEE ALL TRENDING LINK - Button to view full trending page -->
  <div style="text-align: center; margin-top: 2rem;">
    <a href="{{ url_for('trending') }}" class="btn btn-secondary" style="padding: 1rem 2rem;">See All Trending ‚Üí</a>
  </div>
</div>

<!-- DIVIDER - Visual separator between sections -->
<div class="divider"></div>

<!-- ===== CALL TO ACTION SECTION ===== -->
<!-- Encourages users to explore and support local businesses -->
<div style="background: linear-gradient(135deg, var(--color-bg-alt), var(--color-primary-light)); border-radius: var(--radius-lg); padding: 3rem 2rem; text-align: center; margin: 2rem 0;">
  <!-- Main CTA heading -->
  <h2 style="font-size: 2rem; margin: 0 0 1rem; color: var(--color-text);">Support Local Business</h2>
  <!-- CTA description explaining benefits -->
  <p style="font-size: 1.05rem; color: var(--color-text-secondary); margin-bottom: 2rem; max-width: 500px; margin-left: auto; margin-right: auto;">Leave a review and help other discover the best local businesses in Richmond.</p>
  <!-- CTA button - Links to directory to start browsing -->
  <a href="{{ url_for('directory') }}" class="btn btn-primary" style="padding: 1rem 2rem; font-size: 1rem;">Start Exploring</a>
</div>

{% endblock %}
